{% extends "emails/base_email.html" %}
{% load tz %}

{% block title %}Kiírás lemondva - JAR{% endblock %}

{% block header_title %}Kiírás lemondva{% endblock %}

{% block content %}
<p style="font-size: 16px; color: #1e293b;">Kedves Kolléga!</p>

<p><strong>{{ declining_user.get_full_name }}</strong> lemondta a részvételét ezen a mérkőzésen.</p>

<table class="data-table">
    <tr>
        <th>Mérkőzés időpontja</th>
        <td>{{ match.date|date:"Y.m.d" }} ({{ match.date|date:"l" }}) {{ match.time|time:"H:i" }}</td>
    </tr>
    <tr>
        <th>Helyszín</th>
        <td>{{ match.venue.name }}{% if match.venue.city %}, {{ match.venue.city }}{% endif %}</td>
    </tr>
    <tr>
        <th>Bajnokság</th>
        <td>{{ match.phase.competition.name|default:match.competition.name }}</td>
    </tr>
    {% if not match.is_tournament %}
    <tr>
        <th>Hazai csapat</th>
        <td>{{ match.home_team.name|default:"TBD" }}</td>
    </tr>
    <tr>
        <th>Vendég csapat</th>
        <td>{{ match.away_team.name|default:"TBD" }}</td>
    </tr>
    {% endif %}

    <!-- Játékvezetők -->
    {% if all_assignments %}
    <tr class="section-divider">
        <th colspan="2" style="background: #1a365d; color: white; text-align: center; font-size: 13px; padding: 8px;">Játékvezetők</th>
    </tr>
    {% for assign in all_assignments %}
    <tr{% if assign.user.id == declining_user.id %} class="highlight"{% endif %}>
        <th>{{ assign.get_role_display }}</th>
        <td>{% if assign.user.id == declining_user.id %}<span style="color: #dc2626; font-weight: 600;">Hiányzik!</span>{% else %}{{ assign.user.get_full_name }}{% endif %}</td>
    </tr>
    {% endfor %}
    {% endif %}
</table>

{% if assignment.decline_reason %}
<p style="margin-top: 16px;"><strong>Lemondás indoka:</strong> {{ assignment.decline_reason }}</p>
{% endif %}

<p style="margin-top: 24px;">Üdvözlettel,<br>JAR rendszer</p>
{% endblock %}
